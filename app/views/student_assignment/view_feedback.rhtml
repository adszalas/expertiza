<SCRIPT LANGUAGE="JavaScript">
function toggleVis(id) {
                var elem = document.getElementById(id+"_myDiv");
                if(elem.style.display == 'none'){
                        elem.style.display = '';
                        document.getElementById(id+"_show").style.display = 'none';
                        document.getElementById(id+"_hide").style.display = '';
                } else {
                        elem.style.display = 'none';
                        document.getElementById(id+"_show").style.display = '';
                        document.getElementById(id+"_hide").style.display = 'none';
                }
        }
</SCRIPT>

<h1>Feedback for <%= @student.assignment.name %></h1>
<% @assgt = @assignment %>
<% @author = @student %>
<%= render :partial => '/review/wiki' %>
<%  
    review_no = 1
    grade = 0
    for review_map in @review_mapping
        reviews = Review.find_by_sql("SELECT * FROM reviews r,review_mappings m WHERE m.id = #{review_map.id} AND r.review_mapping_id = m.id AND m.assignment_id = 220 AND updated_at = (SELECT max(updated_at) FROM reviews WHERE review_mapping_id = m.id GROUP BY review_mapping_id)")
        for review in reviews%>
                <b>Review <%=review_no%></b> done on <b><%= review.created_at.strftime('%A %B %d %Y, %I:%M%p') %></b>  <a href="#1" onClick="toggleVis('<%=review_no %>');">
                                <span class="inline" id="<%=review_no %>_show">View</span>
                                <span class="inline" id="<%=review_no %>_hide" style="display: none">Hide</span>
                        </a>
                        <br/>
                                <div id="<%=review_no%>_myDiv" style="display:none">
                    <table class="listing" cellpadding=2>
                     <tr>
                        <th>Question</th>
                        <th>Score</th>
                        <th>Comment</th>
                     </tr>

                     <%
                     for review_score in Score.find(:all, :conditions=>["instance_id=? and questionnaire_type_id=?",review.id, QuestionnaireType.find_by_name("Review").id])%>
                        <tr class="listingRow">
                            <td><%=Question.find(review_score.question_id).txt%></td><td align = 'right'><%=review_score.score%>&nbsp;&nbsp;</td><td><%=review_score.comments%></td>
                        </tr>
                    <%end%>
                    </table>
                    <br/>
                    Additional comment : <%=review.additional_comment%><br/>
           		</div>
				<%review_no +=1%>
        <%end
    end%>
    
    <% if review_no-1 <= 0 %>
        <%if @assignment.wiki_type_id == 2 %>
            <%if @assignment.team_assignment %>
                <label>There is no feedback on your work yet.</label>
            <%else%>
				<%_time1 = Time.now.month.to_s + "/" + Time.now.day.to_s + "/" + Time.now.year.to_s%>
                <%if review_mediawiki @assignment.directory_path, _time1, @user_name == ''%>	
                    <label>There is no feedback on your work because it seems that you have not submitted anything for this assignment.</label>
                <%else%>
                    <label>There is no feedback on your work yet.</label>
                <%end%>
            <%end%>
        <%else%>
            <label>There is no feedback on your work yet.</label>
        <%end%>
    <%end%>
<br/>
<a href="javascript:window.history.back()">Back</a>	
	

